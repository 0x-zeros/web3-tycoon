# Web3 Tycoon 地块与卡片系统综合设计文档

## 概述

本文档全面介绍了Web3 Tycoon游戏的地块(tile)和卡片(card)系统设计，包括基础地块类型、卡片系统架构、游戏逻辑规则以及Web3区块链集成方案。本文档基于现有的代码实现和设计文档整理而成。

## 目录

1. [地块系统设计](#地块系统设计)
2. [卡片系统设计](#卡片系统设计)
3. [游戏逻辑规则](#游戏逻辑规则)
4. [Web3区块链集成](#web3区块链集成)
5. [技术实现细节](#技术实现细节)
6. [未来扩展计划](#未来扩展计划)

---

## 地块系统设计

### 基础地块类型

#### 1. 起点地块 (Start Point)
- **功能**：游戏开始位置，通过时获得薪水
- **特征**：
  - 每次经过获得固定收入（通常200-500游戏币）
  - 游戏开始时所有玩家的初始位置
  - 通常位于地图的显著位置（左下角或右下角）
- **交互逻辑**：
  - 停留：无特殊效果
  - 经过：获得薪水奖励

#### 2. 地产地块 (Property Tiles)
- **功能**：可购买、建设、收租的核心地块
- **属性**：
  - 地价：购买该地块的初始费用
  - 租金等级：不同建设阶段的租金标准 [空地, 房屋1-4, 酒店]
  - 建设费用：建造房屋或商店的费用
  - 颜色分组：同色地产形成垄断时租金加倍
- **状态类型**：
  - 无主地：可以购买
  - 有主地：需要支付租金
  - 抵押地：暂时不收租金

#### 3. 功能地块 (Functional Tiles)

##### 3.1 银行 (Bank)
- **服务内容**：
  - 存款：获得利息收入
  - 贷款：应急资金，需要还利息
  - 汇率兑换：不同货币间的转换
  - 保险服务：购买各种保险

##### 3.2 商店 (Shop)
- **商品类型**：
  - 基础道具：骰子、卡片等
  - 建筑材料：加速建设的材料
  - 特殊物品：限时或稀有道具

##### 3.3 彩票站 (Lottery)
- **类型**：
  - 普通彩票：固定概率和奖金
  - 累积彩票：奖池不断累积
  - 刮刮乐：即时开奖类型

##### 3.4 新闻站 (News Station)
- **事件类型**：
  - 股市波动：影响股票价格
  - 政策变化：影响房价或租金
  - 天气事件：影响特定区域
  - 社会事件：全局性影响

##### 3.5 魔法屋 (Magic House)
- **效果类型**：
  - 正面效果：获得金钱、道具、能力
  - 负面效果：失去金钱、强制移动
  - 随机效果：不可预测的结果
  - 选择效果：玩家可以选择不同选项

#### 4. 事件地块 (Event Tiles)

##### 4.1 机会地块 (Chance)
- **功能**：触发随机正面或中性事件
- **事件类型**：
  - 金钱类：获得或失去金钱
  - 移动类：强制或自由移动
  - 道具类：获得特殊道具
  - 规则类：临时改变游戏规则

##### 4.2 命运地块 (Destiny)
- **功能**：触发重大命运转折
- **特征**：
  - 影响更大：效果比机会更显著
  - 长期影响：可能有持续性效果
  - 剧情性：与游戏背景故事相关

#### 5. 特殊地块 (Special Tiles)

##### 5.1 奖励地块 (Bonus Tile)
- **功能**：直接发钱的奖励地块
- **特征**：
  - 停留时直接获得200游戏币
  - 无任何负面效果

##### 5.3 费用地块 (Fee Tile)
- **功能**：直接扣钱的费用地块
- **特征**：
  - 停留时直接扣除200游戏币
  - 与奖励地块形成平衡对比

##### 5.4 卡片站地块 (Card Station)
- **功能**：随机获得卡片的奖励地块
- **触发条件**：
  - 经过时自动触发（无需停留）
  - 每次经过随机获得1张卡片
- **卡片类型**：
  - 免罚卡：免除一次罚款或税收
  - 控制骰子卡：下次投掷可选择点数
  - 陷害卡：指定对手直接入狱
  - 免费建房卡：在拥有地产上免费建造一栋房屋
  - 收租加倍卡：下次收租金额翻倍

---

## 卡片系统设计

### 卡片类型体系

#### 1. 基础卡片类型

##### 1.1 遥控骰子卡 (Dice Control Card)
- **功能**：控制下次投掷的点数
- **使用时机**：掷骰前
- **效果**：选择1-6中的任意点数作为下次骰子结果

##### 1.2 路障卡 (Barrier Card)
- **功能**：在地块上放置路障阻挡其他玩家
- **使用时机**：立即使用
- **效果**：指定地块设置路障，持续3回合

##### 1.3 传送卡 (Teleport Card)
- **功能**：瞬间移动到指定地块
- **使用时机**：立即使用
- **效果**：选择地图任意地块立即传送
- **特性**：
  - 无视距离限制
  - 可配置是否允许传送到特殊地块
  - 支持传送费用设置

##### 1.4 拆除卡 (Demolish Card)
- **功能**：拆除敌方建筑物
- **使用时机**：立即使用
- **效果**：选择敌方建筑降级一级

##### 1.5 免租卡 (Free Rent Card)
- **功能**：下次踩到别人地产时免付租金
- **使用时机**：立即使用
- **效果**：给自己添加免租状态，下次需要支付租金时免费

#### 2. 卡片使用机制

##### 2.1 使用时机 (Usage Timing)
- **立即使用** (INSTANT)：获得后可立即使用
- **回合开始** (TURN_START)：在自己回合开始时使用
- **掷骰前** (BEFORE_DICE)：在掷骰子之前使用
- **被动触发** (PASSIVE)：满足特定条件时自动触发

##### 2.2 目标类型 (Target Type)
- **无目标** (NONE)：卡片效果不需要选择目标
- **自己** (SELF)：只能对自己使用
- **其他玩家** (OTHER_PLAYER)：选择一个其他玩家作为目标
- **地块** (TILE)：选择地图上的一个地块
- **建筑** (BUILDING)：选择一个建筑物

##### 2.3 稀有度体系 (Rarity)
- **普通** (COMMON)：容易获得的基础卡片
- **稀有** (RARE)：较难获得，效果较强
- **史诗** (EPIC)：很难获得，效果很强
- **传说** (LEGENDARY)：极难获得，效果极强

#### 3. 卡片状态管理

##### 3.1 卡片状态
- **可用** (AVAILABLE)：可以正常使用
- **冷却中** (COOLING_DOWN)：正在冷却，暂时不可用
- **已使用** (USED)：已经使用，等待销毁或回收
- **被封印** (SEALED)：被特殊效果封印，不可使用

##### 3.2 卡片获取方式
- **随机获得**：通过特定地块或事件获得
- **商店购买**：使用游戏币购买
- **任务奖励**：完成特定任务获得
- **玩家交易**：玩家间可以交易卡片

---

## 游戏逻辑规则

### 地产系统规则

#### 1. 购买规则
- 无主地产可以被任何玩家购买
- 购买后立即获得该地产的所有权
- 购买费用从玩家现金中扣除

#### 2. 建设规则
- 只有地产拥有者才能在自己的地产上建设
- 建设需要消耗现金和回合
- 建筑等级依次递增：空地 → 房屋1-4级 → 酒店
- 抵押中的地产无法建设

#### 3. 租金收取规则
- 其他玩家停留在有主地产时需要支付租金
- 租金金额根据建筑等级决定
- 如果玩家拥有同色组的所有地产，租金加倍
- 抵押中的地产不收租金

#### 4. 垄断规则
- 当玩家拥有同色组的所有地产时形成垄断
- 垄断状态下该组地产的租金加倍
- 垄断可以带来额外的战略优势

### 卡片系统规则

#### 1. 卡片使用限制
- 每回合只能使用有限张卡片
- 某些卡片有冷却时间
- 某些卡片只能对特定目标使用

#### 2. 卡片效果处理
- 卡片效果立即生效或持续多个回合
- 效果可以被其他卡片抵消或增强
- 特殊状态会影响卡片的使用

#### 3. 卡片平衡机制
- 强力卡片需要限制使用次数或增加获取难度
- 攻击卡片需要对应的防御卡片来平衡
- 经济影响类卡片需要设置上限避免游戏失衡

---

## Web3区块链集成

### NFT系统设计

#### 1. 卡片NFT化
- **稀有卡片作为NFT**：
  - 稀有卡片具有唯一性和可交易性
  - 不同稀有度的卡片有不同的视觉效果
  - 玩家可以在二级市场交易特殊卡片

#### 2. 地产NFT化
- **地产作为NFT资产**：
  - 玩家拥有的地产可以铸造为NFT
  - 支持跨游戏平台的资产转移
  - 地产价值与游戏内表现挂钩

#### 3. 地图NFT化
- **稀有地图作为收藏品**：
  - 特殊设计的地图可以作为NFT
  - 地图可以通过游戏进度解锁新区域
  - 社区通过DAO决定新地图的设计

---

## 技术实现细节

### 数据结构设计

#### 1. 地块数据结构
```typescript
interface MapTileData {
  id: number;
  type: TileType;
  name: string;
  position: Position3D;
  state: TileState;
  renderConfig: RenderConfig;
  // 特定类型数据
  propertyData?: PropertyData;
  taxData?: TaxData;
  cardStationData?: CardStationData;
}
```

#### 2. 卡片数据结构
```typescript
interface CardData {
  id: string;
  type: CardType;
  name: string;
  rarity: CardRarity;
  usageTiming: CardUsageTiming;
  targetType: CardTargetType;
  effects: CardEffectParams[];
  visualConfig: CardVisualConfig;
}
```

### 渲染和交互系统

#### 1. 地块渲染
- 支持3D地块模型渲染
- 动态地块状态更新
- 建筑等级可视化显示

#### 2. 卡片交互
- 拖拽使用卡片
- 目标选择界面
- 效果动画和音效

#### 3. UI系统
- 地产信息面板
- 卡片手牌管理
- 玩家状态显示

---

## 未来扩展计划

### 短期计划 (MVP后)

#### 1. 卡片系统完善
- 实现所有预定义卡片类型
- 添加卡片合成和升级系统
- 完善卡片平衡机制

#### 2. 地块系统扩展
- 添加更多功能地块类型
- 实现地块事件系统
- 优化地块渲染性能

#### 3. Web3功能集成
- 实现基础的代币系统
- 添加NFT卡片铸造

### 长期计划

#### 1. 高级游戏机制
- 股票市场系统
- 公司经营玩法
- 多地图联机对战

#### 2. 社区功能
- 用户创建地图
- 卡片定制系统
- DAO治理机制

#### 3. 跨链扩展
- 支持多区块链网络
- 跨链资产转移
- 全球玩家社区

---

本文档将持续更新，反映最新的设计决策和技术实现。如有问题或建议，请联系开发团队。
