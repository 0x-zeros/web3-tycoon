


# Move 2024 新语法速查与示例

 Move 2024 语法要点：
  1. Vector：使用索引 `v[i]` 和方法调用 `v.push_back(x)`、`v.length()`，空向量用 `vector[]`
  2. Table：保持传统函数调用 `table::borrow(&t, key)`、`table::add(&mut t, key, value)` 以区分 Vector
  3. Option：必须用模块前缀 `option::some(x)` 和 `option::none()`，导入 `use std::option::{Self, Option}`
  4. 结构体：优先使用引用 `let player = &game.players[i]` 而非复制，访问字段 `(&game.players[i]).owner`

 或者更简洁的单条版本：

  Move 2024：Vector 用新语法（索引`v[i]`、方法`.push_back()`），Table 保持函数式（`table::borrow()`）以示区分，Option
  需前缀（`option::some()`），复杂类型优先引用避免复制。

  

## 1. vector 的 `[]` 索引语法

Move 2024 支持用 `v[i]` 这种下标方式访问 vector 元素。底层会自动调用 `vector::borrow` 或 `vector::borrow_mut`。

**示例：**
```move
let mut v = vector[1, 2, 3];
let x = v[0];        // 等价于 *vector::borrow(&v, 0)
v[1] = 10;           // 等价于 *vector::borrow_mut(&mut v, 1) = 10;
```



---

## 2. object.fun 的方法语法

Move 2024 支持方法调用语法，比如 `object.fun()`，等价于 `fun(&object)` 或 `fun(&mut object)`。  
你可以直接用 `v.push_back(x)` 代替 `vector::push_back(&mut v, x)`。

**示例：**
```move
let mut v = vector[];
v.push_back(42);      // 等价于 vector::push_back(&mut v, 42)

let value = c.value(); // 如果 c 是 Coin，等价于 coin::value(&c)
```

---

## 3. 其他 2024 新语法推荐

### 3.1 struct 的位置字段（Positional Fields）

```move
public struct Pair(u64, u64) has copy, drop, store;

public fun sum(p: &Pair): u64 {
  p.0 + p.1
}
```

### 3.2 `public(package)` 取代 `friend`

```move
public(package) fun only_for_package() { ... }
```

**参考文档：**  
- [Move 2024 Migration Guide](https://docs.sui.io/guides/developer/advanced/move-2024-migration)


#### vector 相关 reference 文档

- [vector module reference (官方源码)](https://github.com/MystenLabs/sui/blob/181e54168de00041dbf0eec91a66c21a4926dd05/external-crates/move/crates/move-stdlib/sources/vector.move)






