# 地块颜色测试设置指南

## 问题描述
地块的 `material.setProperty('mainColor', currentColor)` 无法成功设置颜色，完全没有变化。

## 解决方案
已更新 `MapTile.ts` 中的颜色设置逻辑：
1. 使用 Vec4 格式设置颜色（0-1范围）而不是 Color 对象
2. 尝试多个材质属性名称（albedo, mainColor, baseColor, diffuse, u_color）
3. 添加默认材质创建的回退机制
4. 增强调试输出以显示可用的材质属性

## 测试步骤

### 1. 创建简单的测试场景

在 Cocos Creator 中：

1. 创建新场景 `test_map.scene`
2. 添加一个空节点作为地块容器
3. 创建一个基础的立方体预制件作为地块

### 2. 设置地块预制件

1. 创建预制件 `TestTile.prefab`：
   - 根节点：`Node`
   - 子节点：带有 `MeshRenderer` 的 `MeshRenderer` 组件
   - 几何体：使用内置的立方体或平面
   - 材质：使用 `builtin-standard` 材质

2. 在预制件上添加 `MapTile` 组件

### 3. 使用测试脚本

已创建 `assets/scripts/test/MapColorTest.ts` 测试脚本：

```typescript
// 主要功能：
// 1. 自动创建测试地块
// 2. 每2秒切换预定义颜色
// 3. 提供手动随机颜色测试方法
```

### 4. 场景设置

1. 在场景中创建空节点，挂载 `MapColorTest` 脚本
2. 设置 `tilePrefab` 属性为你创建的 `TestTile` 预制件
3. 设置 `testContainer` 为地块的父容器节点

### 5. 运行测试

1. 播放场景
2. 观察控制台输出，查看：
   - 材质属性检测结果
   - 颜色设置是否成功
   - 错误信息（如果有）

3. 观察地块颜色是否每2秒变化一次

## 预期结果

如果修复成功，你应该看到：
- 控制台输出显示成功找到并设置了材质属性
- 地块颜色每2秒在红、绿、蓝、黄、洋红、青色之间切换
- 没有错误信息

## 排查问题

如果颜色仍然无法设置：

1. **检查材质**：确保地块有有效的材质
2. **检查着色器**：材质使用的着色器必须支持颜色属性
3. **检查属性名**：不同着色器可能使用不同的颜色属性名

## 备选解决方案

如果材质属性设置仍然无效，可以考虑：

1. **直接替换材质**：为不同颜色创建不同的材质文件
2. **使用 Sprite 组件**：如果是2D地块，使用 Sprite 组件可能更合适
3. **自定义着色器**：创建专门的着色器来支持动态颜色变化

## 下一步

1. 测试当前的修复是否有效
2. 如果无效，检查具体使用的材质和着色器类型
3. 根据实际材质类型调整颜色设置方法